# Правила структуры проекта ViridiscaUi

## Общие принципы организации

ViridiscaUi использует архитектуру на основе папок вместо Clean Architecture в виде отдельных проектов. Данное правило определяет, как должны создаваться, именоваться и организовываться папки и файлы.

## Структура проекта

### Корневая структура
- `ViridiscaUi` - основное приложение с UI
- `ViridiscaUi.Desktop` - реализация для десктоп-платформы
- `ViridiscaUi.Domain` - доменная модель и бизнес-логика

### ViridiscaUi.Domain

```
ViridiscaUi.Domain/
├── Models/                   # Модели данных
│   ├── Base/                 # Базовые интерфейсы и абстрактные классы
│   ├── Education/            # Модели связанные с образовательным процессом
│   ├── Auth/                 # Модели аутентификации и авторизации
│   └── [ДоменнаяОбласть]/    # Другие логические области домена
├── Services/                 # Сервисы бизнес-логики
│   ├── Interfaces/           # Интерфейсы сервисов
│   └── Implementations/      # Реализации сервисов
├── Repositories/             # Репозитории для доступа к данным
│   ├── Interfaces/           # Интерфейсы репозиториев
│   └── Implementations/      # Реализации репозиториев
└── DTOs/                     # Объекты передачи данных
```

### ViridiscaUi

```
ViridiscaUi/
├── Assets/                   # Ресурсы приложения (изображения, шрифты и т.д.)
├── Controls/                 # Пользовательские элементы управления
├── ViewModels/               # Модели представления
│   ├── Base/                 # Базовые классы для ViewModels
│   ├── [ФункциональнаяОбласть]/ # Группировка по функциональным областям (Auth, Students, Courses и т.д.)
│   └── Dialogs/              # ViewModels для диалоговых окон
├── Views/                    # Представления
│   ├── [ФункциональнаяОбласть]/ # Группировка по функциональным областям
│   └── Dialogs/              # Диалоговые окна
├── Components/               # Функциональные компоненты (для Avalonia.FuncUI)
│   ├── Common/               # Общие компоненты
│   └── [ФункциональнаяОбласть]/ # Компоненты для функциональных областей
├── Pages/                    # Страницы приложения на FuncUI
├── Services/                 # UI-сервисы
│   ├── Interfaces/           # Интерфейсы сервисов
│   └── Implementations/      # Реализации сервисов
├── Styles/                   # Стили и ресурсы
├── Converters/               # Конвертеры значений
├── Extensions/               # Расширения
├── Helpers/                  # Вспомогательные классы
└── DI/                       # Конфигурация внедрения зависимостей
```

### ViridiscaUi.Desktop

```
ViridiscaUi.Desktop/
└── Platform/                 # Платформо-зависимый код
```

## Правила именования

### Общие правила

1. Используйте PascalCase для имен классов, интерфейсов, свойств и методов
2. Используйте camelCase для приватных полей и локальных переменных
3. Префикс `I` для интерфейсов (например, `IStudentRepository`)
4. Префикс `_` для приватных полей (например, `private readonly IStudentService _studentService;`)

### Идентификаторы и ключи

1. Используйте `Guid` вместо `int` для идентификаторов
2. Именуйте идентификаторы как `Uid` вместо `Id`
3. Все модели должны иметь уникальный идентификатор типа `Guid`
4. При создании нового объекта используйте `Guid.NewGuid()` для генерации идентификатора

```csharp
// Пример корректного определения модели
public class Student
{
    public Guid Uid { get; set; } = Guid.NewGuid();
    public string FirstName { get; set; }
    public string LastName { get; set; }
    // другие свойства
}
```

### Специфические правила

1. **ViewModels**: Суффикс `ViewModel` (например, `StudentViewModel`, `CourseViewModel`)
2. **Views**:
   - Для страниц: Суффикс `View` (например, `StudentView`, `CourseView`)
   - Для окон: Суффикс `Window` (например, `MainWindow`, `SettingsWindow`)
   - Для контролов: Суффикс `Control` (например, `StudentCardControl`)
   - Для диалогов: Суффикс `Dialog` (например, `ConfirmationDialog`)
3. **Models**: Без суффиксов (например, `Student`, `Course`)
4. **Services**: Суффикс `Service` (например, `StudentService`, `AuthService`)
5. **Repositories**: Суффикс `Repository` (например, `StudentRepository`)
6. **Factories**: Суффикс `Factory` (например, `ViewModelFactory`, `DialogFactory`)
7. **Components**: Для FuncUI компонентов используйте суффикс `Component` или группируйте в классах с суффиксом `Components` (например, `StudentCardComponent`, `StudentComponents`)

## Правила по ReactiveUI

1. Используйте `ReactiveObject` в качестве базового класса для ViewModels
2. Используйте `IObservable<T>` для реактивных свойств
3. Используйте `ReactiveCommand<TParam, TResult>` вместо `ICommand`
4. Используйте `this.WhenAnyValue()` для подписки на изменения свойств
5. Используйте `ToProperty()` для создания выходных свойств
6. Обеспечивайте очистку подписок при уничтожении объектов

## Правила по Avalonia

1. Отделяйте логику представления от логики бизнеса
2. Используйте привязку данных для взаимодействия View и ViewModel
3. Избегайте использования кода в code-behind, кроме инициализации
4. Используйте стили для консистентного внешнего вида
5. Группируйте стили в ресурсных словарях
6. Максимально используйте XAML для UI вместо создания UI в коде

## Работа с асинхронными операциями

1. Используйте асинхронное программирование (`async/await`) для длительных операций
2. Используйте `Task<T>` вместо `void` для асинхронных методов
3. Используйте реактивные расширения для сложных асинхронных потоков
4. Избегайте блокирующих вызовов в UI-потоке

## Рекомендации по коду

1. Пишите небольшие, модульные и тестируемые функции
2. Применяйте инъекцию зависимостей для слабой связанности компонентов
3. Избегайте излишней вложенности кода (не более 3-4 уровней)
4. Используйте nullable reference types (`string?`, `Student?`)
5. Комментируйте сложные алгоритмы или неочевидные решения
6. Следуйте принципу DRY (Don't Repeat Yourself) 